
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../practica04/practica04.html">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.1.7">
    
    
      
        <title>Práctica 5 - LPP</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="Teal" data-md-color-accent="Teal">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#practica-5-funciones-como-datos-de-primera-clase-y-funciones-de-orden-superior" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="LPP" class="md-header__button md-logo" aria-label="LPP" data-md-component="logo">
      
  <img src="../../imagenes/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LPP
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Práctica 5
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="LPP" class="md-nav__button md-logo" aria-label="LPP" data-md-component="logo">
      
  <img src="../../imagenes/logo.png" alt="logo">

    </a>
    LPP
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Teoría
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Teoría
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoria/tema00-descripcion-asignatura/tema00-descripcion-asignatura.html" class="md-nav__link">
        Descripción de la asignatura
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoria/tema01-historia-lenguajes-programacion/tema01-historia-lenguajes-programacion.html" class="md-nav__link">
        Tema 1: Historia de los lenguajes de programación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoria/tema02-programacion-funcional/tema02-programacion-funcional.html" class="md-nav__link">
        Tema 2: Programación funcional
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../teoria/tema03-procedimientos-recursivos/tema03-procedimientos-recursivos.html" class="md-nav__link">
        Tema 3: Procedimientos recursivos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Seminarios
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Seminarios
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../seminarios/seminario1-scheme/seminario1-scheme.html" class="md-nav__link">
        Seminario de Scheme
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Prácticas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Prácticas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../buenas-practicas-programacion-funcional.html" class="md-nav__link">
        Buenas prácticas de programación funcional
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practica01/practica01.html" class="md-nav__link">
        Práctica 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practica02/practica02.html" class="md-nav__link">
        Práctica 2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practica03/practica03.html" class="md-nav__link">
        Práctica 3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../practica04/practica04.html" class="md-nav__link">
        Práctica 4
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Práctica 5
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="practica05.html" class="md-nav__link md-nav__link--active">
        Práctica 5
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#antes-de-la-clase-de-practicas" class="md-nav__link">
    Antes de la clase de prácticas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicios" class="md-nav__link">
    Ejercicios
  </a>
  
    <nav class="md-nav" aria-label="Ejercicios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio-1" class="md-nav__link">
    Ejercicio 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-2" class="md-nav__link">
    Ejercicio 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-3" class="md-nav__link">
    Ejercicio 3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-4" class="md-nav__link">
    Ejercicio 4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-5" class="md-nav__link">
    Ejercicio 5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-6" class="md-nav__link">
    Ejercicio 6
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#antes-de-la-clase-de-practicas" class="md-nav__link">
    Antes de la clase de prácticas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejercicios" class="md-nav__link">
    Ejercicios
  </a>
  
    <nav class="md-nav" aria-label="Ejercicios">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejercicio-1" class="md-nav__link">
    Ejercicio 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-2" class="md-nav__link">
    Ejercicio 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-3" class="md-nav__link">
    Ejercicio 3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-4" class="md-nav__link">
    Ejercicio 4
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-5" class="md-nav__link">
    Ejercicio 5
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejercicio-6" class="md-nav__link">
    Ejercicio 6
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="practica-5-funciones-como-datos-de-primera-clase-y-funciones-de-orden-superior">Práctica 5: Funciones como datos de primera clase y funciones de orden superior<a class="headerlink" href="#practica-5-funciones-como-datos-de-primera-clase-y-funciones-de-orden-superior" title="Permanent link">&para;</a></h1>
<h2 id="antes-de-la-clase-de-practicas">Antes de la clase de prácticas<a class="headerlink" href="#antes-de-la-clase-de-practicas" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Antes de empezar esta práctica es importante que revises la solución
  de la práctica 4. Puedes preguntar las dudas al profesor de prácticas.</p>
</li>
<li>
<p>Los siguientes ejercicios están basados en los conceptos de teoría
vistos la semana pasada. Antes de la clase de prácticas debes repasar
todos los conceptos y <strong>probar en el DrRacket</strong> todos los ejemplos de
los siguientes apartados del tema 2 <a href="../../teoria/tema02-programacion-funcional/tema02-programacion-funcional.html#54-generalizacion"><em>Programación
Funcional</em></a>:</p>
<ul>
<li>5.4. Generalización. </li>
<li>5.5. Funciones que devuelven otras funciones. </li>
<li>5.6. Funciones en estructuras de datos. </li>
<li>5.7. Funciones de orden superior.</li>
</ul>
</li>
</ul>
<h2 id="ejercicios">Ejercicios<a class="headerlink" href="#ejercicios" title="Permanent link">&para;</a></h2>
<p>Descarga el <a href="https://raw.githubusercontent.com/domingogallardo/apuntes-lpp/master/src/lpp.rkt">fichero <code>lpp.rkt</code></a>,
pulsando el botón derecho del ratón y seleccionando la opción <em>Guardar
como</em> <code>lpp.rkt</code>. Guárdalo en la misma carpeta en la que tengas el
fichero <code>practica5.rkt</code>.</p>
<p>El fichero contiene la definición de las funciones de orden superior <code>exists?</code> y <code>for-all?</code>.</p>
<h3 id="ejercicio-1">Ejercicio 1<a class="headerlink" href="#ejercicio-1" title="Permanent link">&para;</a></h3>
<p>a) Define la función recursiva <code>(aplica-veces f1 f2 n x)</code> que aplica
<code>n</code> veces las funciones <code>f2</code> y <code>f1</code> al número <code>x</code>. </p>
<p>Por ejemplo, <code>(aplica-veces doble suma-2 3 5)</code> deberá devolver el
resultado de sumarle 2 a 5 (7), después calcular el doble (14),
después sumarle otra vez 2 al resultado (16), volver a calcular su
doble (32) y, por último, sumarle 2 al resultado (34) y calcular su
doble. Esto es, aplica 3 veces las funciones <code>suma-2</code> y <code>doble</code>
tomando como número inicial el 5. El resultado será 68.</p>
<p>Ejemplos:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">aplica-veces</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="c1">; ⇒ 16</span>
<span class="p">(</span><span class="n">aplica-veces</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="c1">; ⇒ 7072978201</span>
</code></pre></div>
<p>b) Implementa la función recursiva <code>(mueve-al-principio-condicion pred
lista)</code> que recibe un predicado y una lista. La función es una
generalización de la función de la práctica anterior y debe devolver
la lista resultante de mover la primera aparición del dato que cumpla
el predicado al comienzo de la lista, dejando el resto de la lista sin
modificar.</p>
<p>A diferencia de la práctica anterior, en la lista puede no haber
ningún elemento que cumpla el predicado. En ese caso se devolverá la
lista original.</p>
<p>Ejemplos:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">mueve-al-principio-condicion</span><span class="w"> </span><span class="nb">number?</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">a</span><span class="w"> </span><span class="ss">b</span><span class="w"> </span><span class="ss">c</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ss">d</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ss">e</span><span class="p">)</span><span class="w"> </span><span class="c1">; ⇒ (1 a b c d 1 e)</span>
<span class="p">(</span><span class="n">mueve-al-principio-condicion</span><span class="w"> </span><span class="nb">number?</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">b</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ss">c</span><span class="p">))</span><span class="w"> </span><span class="c1">; ⇒ (1 a b 1 c)</span>
<span class="p">(</span><span class="n">mueve-al-principio-condicion</span><span class="w"> </span><span class="nb">number?</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">a</span><span class="w"> </span><span class="ss">b</span><span class="w"> </span><span class="ss">c</span><span class="w"> </span><span class="ss">d</span><span class="p">))</span><span class="w"> </span><span class="c1">; ⇒ &#39;(a b c d)</span>
</code></pre></div>
<div class="admonition hint">
<p class="admonition-title">Pista</p>
<p>El hecho de que se permita que no haya ningún elemento que cumpla
el predicado obliga a cambiar bastante la solución de la práctica
anterior. </p>
<p>Fíjate por ejemplo en la función <code>(inserta-en-segunda-posicion
dato lista)</code> de la solución. En el caso en que no haya en la lista
ningún elemento que cumpla la condición esta función deberá
<strong>añadir en cabeza</strong> el dato, en lugar de insertarlo en segunda
posición. De hecho, podríamos cambiar el nombre de la función
auxiliar y llamarla <code>inserta-segundo-cond</code> o algo así.</p>
</div>
<p>c) Vamos a generalizar la función de la práctica anterior
<code>(comprueba-simbolos)</code> llamándola <code>(comprueba pred lista1
lista2)</code> y pasándole como parámetro un predicado de comparación. La
función ahora podrá procesar cualquier tipo de listas (de símbolos, de
cadenas, de listas, etc.). La función pasada como parámetro se encarga
de comparar si el elemento de la primera lista cumple la condición con el
elemento de la segunda.</p>
<p>Implementa la función <code>(comprueba pred lista1 lista2)</code>.</p>
<p>Ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">comprueba</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="w">             </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="p">(</span><span class="nb">string-length</span><span class="w"> </span><span class="p">(</span><span class="nb">symbol-&gt;string</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="n">y</span><span class="p">))</span>
<span class="w">           </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">este</span><span class="w"> </span><span class="ss">es</span><span class="w"> </span><span class="ss">un</span><span class="w"> </span><span class="ss">ejercicio</span><span class="w"> </span><span class="ss">de</span><span class="w"> </span><span class="ss">examen</span><span class="p">)</span><span class="w"> </span>
<span class="w">           </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">6</span><span class="p">))</span>
<span class="c1">; ⇒ ((un . 2) (ejercicio . 9) (examen . 6))</span>

<span class="p">(</span><span class="n">comprueba</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="w">              </span><span class="p">(</span><span class="nb">=</span><span class="w"> </span><span class="p">(</span><span class="nb">string-length</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">string-length</span><span class="w"> </span><span class="n">y</span><span class="p">)))</span>
<span class="w">             </span><span class="o">&#39;</span><span class="p">(</span><span class="s2">&quot;aui&quot;</span><span class="w"> </span><span class="s2">&quot;a&quot;</span><span class="w"> </span><span class="s2">&quot;ae&quot;</span><span class="w"> </span><span class="s2">&quot;c&quot;</span><span class="w"> </span><span class="s2">&quot;aeiou&quot;</span><span class="p">)</span>
<span class="w">             </span><span class="o">&#39;</span><span class="p">(</span><span class="s2">&quot;hola&quot;</span><span class="w"> </span><span class="s2">&quot;b&quot;</span><span class="w"> </span><span class="s2">&quot;es&quot;</span><span class="w"> </span><span class="s2">&quot;que&quot;</span><span class="w"> </span><span class="s2">&quot;cinco&quot;</span><span class="p">))</span>
<span class="c1">; ⇒ ((&quot;a&quot; . &quot;b&quot;) (&quot;ae&quot; . &quot;es&quot;) (&quot;aeiou&quot; . &quot;cinco&quot;))</span>
</code></pre></div>
<h3 id="ejercicio-2">Ejercicio 2<a class="headerlink" href="#ejercicio-2" title="Permanent link">&para;</a></h3>
<p>Queremos ordenar de menor a mayor una lista que contenga cualquier
tipo de elemento, no solo números. Para ello vamos a generalizar el
ejercicio 2 de la práctica anterior, añadiendo un parámetro funcional,
un predicado <code>(menor-igual? dato1 dato2)</code> que nos dice si el dato1 es
menor o igual que el dato 2.</p>
<p>a) Generaliza las funciones <code>inserta-ordenada</code> y <code>ordena</code> añadiéndoles
el parámetro adicional <code>menor-igual?</code> que es una función predicado que
comprueba si un dato de los que componen la lista es menor o igual que
otro. Llama a las funciones resultantes <code>inserta-ordenada-genérica</code> y
<code>ordena-genérica</code>.</p>
<p>b) Escribe tres pruebas. En la primera deberás ordenar una lista de
cadenas por su longitud, en la segunda la lista de cadenas por su
orden lexicográfico y en la tercera deberás ordenar una lista de
parejas de números por la suma de su parte izquierda y su parte
derecha:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">check-equal?</span><span class="w"> </span><span class="p">(</span><span class="n">ordena-generica</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="s2">&quot;Hola&quot;</span><span class="w"> </span><span class="s2">&quot;me&quot;</span><span class="w"> </span><span class="s2">&quot;llamo&quot;</span><span class="w"> </span><span class="s2">&quot;Iñigo&quot;</span><span class="w"> </span><span class="s2">&quot;Montoya&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">......</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="s2">&quot;me&quot;</span><span class="w"> </span><span class="s2">&quot;Hola&quot;</span><span class="w"> </span><span class="s2">&quot;llamo&quot;</span><span class="w"> </span><span class="s2">&quot;Iñigo&quot;</span><span class="w"> </span><span class="s2">&quot;Montoya&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="n">check-equal?</span><span class="w"> </span><span class="p">(</span><span class="n">ordena-generica</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="s2">&quot;Hola&quot;</span><span class="w"> </span><span class="s2">&quot;me&quot;</span><span class="w"> </span><span class="s2">&quot;llamo&quot;</span><span class="w"> </span><span class="s2">&quot;Iñigo&quot;</span><span class="w"> </span><span class="s2">&quot;Montoya&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">.......</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="s2">&quot;Hola&quot;</span><span class="w"> </span><span class="s2">&quot;Iñigo&quot;</span><span class="w"> </span><span class="s2">&quot;Montoya&quot;</span><span class="w"> </span><span class="s2">&quot;llamo&quot;</span><span class="w"> </span><span class="s2">&quot;me&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="n">check-equal?</span><span class="w"> </span><span class="p">(</span><span class="n">ordena-generica</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">2</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="n">......</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span>
</code></pre></div>
<p>c) Define la función <code>(ordena-cartas lista-cartas)</code> que ordene una
lista de cartas de menor a mayor valor usando la función anterior
<code>ordena-generica</code>. Deberás incluir la función <code>valor-carta</code> y sus
funciones auxiliares definidas en prácticas anteriores.</p>
<p>Ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">ordena-cartas</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">Q♠</span><span class="w"> </span><span class="ss">J♣</span><span class="w"> </span><span class="ss">5♣</span><span class="w"> </span><span class="ss">Q♥</span><span class="w"> </span><span class="ss">J♦</span><span class="p">))</span><span class="w"> </span><span class="c1">; ⇒ &#39;(5♣ J♣ J♦ Q♠ Q♥)</span>
</code></pre></div>
<h3 id="ejercicio-3">Ejercicio 3<a class="headerlink" href="#ejercicio-3" title="Permanent link">&para;</a></h3>
<p>a) Indica qué devuelven las siguientes expresiones, sin utilizar el
intérprete. Comprueba después si has acertado.</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">         </span><span class="p">(</span><span class="k">cond</span><span class="w"> </span>
<span class="w">            </span><span class="p">((</span><span class="nb">symbol?</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">symbol-&gt;string</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">            </span><span class="p">((</span><span class="nb">number?</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">number-&gt;string</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">            </span><span class="p">((</span><span class="nb">boolean?</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="s2">&quot;#t&quot;</span><span class="w"> </span><span class="s2">&quot;#f&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="p">(</span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;desconocido&quot;</span><span class="p">)))</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="no">#t</span><span class="w"> </span><span class="ss">hola</span><span class="w"> </span><span class="no">#f</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">2</span><span class="p">)))</span><span class="w"> </span><span class="c1">; ⇒ ?</span>

<span class="p">(</span><span class="nb">filter</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span>
<span class="w">            </span><span class="p">(</span><span class="nb">equal?</span><span class="w"> </span><span class="p">(</span><span class="nb">string-ref</span><span class="w"> </span><span class="p">(</span><span class="nb">symbol-&gt;string</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="sc">#\a</span><span class="p">))</span><span class="w"> </span>
<span class="w">    </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">alicante</span><span class="w"> </span><span class="ss">barcelona</span><span class="w"> </span><span class="ss">madrid</span><span class="w"> </span><span class="ss">almería</span><span class="p">))</span><span class="w"> </span><span class="c1">; ⇒ ?</span>

<span class="p">(</span><span class="nb">foldr</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">dato</span><span class="w"> </span><span class="n">resultado</span><span class="p">)</span>
<span class="w">          </span><span class="p">(</span><span class="nb">string-append</span><span class="w"> </span><span class="n">dato</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="w"> </span><span class="n">resultado</span><span class="p">))</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span>
<span class="w">          </span><span class="o">&#39;</span><span class="p">(</span><span class="s2">&quot;Hola&quot;</span><span class="w"> </span><span class="s2">&quot;que&quot;</span><span class="w"> </span><span class="s2">&quot;tal&quot;</span><span class="p">))</span><span class="w"> </span><span class="c1">; ⇒ ?</span>

<span class="p">(</span><span class="nb">foldr</span><span class="w"> </span><span class="nb">append</span><span class="w"> </span><span class="o">&#39;</span><span class="p">()</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span><span class="w"> </span><span class="c1">; ⇒ ?</span>

<span class="p">(</span><span class="nb">foldl</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">dato</span><span class="w"> </span><span class="n">resultado</span><span class="p">)</span>
<span class="w">         </span><span class="p">(</span><span class="nb">string-append</span>
<span class="w">          </span><span class="p">(</span><span class="nb">symbol-&gt;string</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="n">dato</span><span class="p">))</span>
<span class="w">          </span><span class="p">(</span><span class="nb">symbol-&gt;string</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="n">dato</span><span class="p">))</span>
<span class="w">          </span><span class="n">resultado</span><span class="p">))</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="ss">a</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="ss">b</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">hola</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="ss">adios</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">una</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="ss">pareja</span><span class="p">)))</span><span class="w"> </span><span class="c1">; ⇒ ?</span>

<span class="p">(</span><span class="nb">foldr</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">dato</span><span class="w"> </span><span class="n">resultado</span><span class="p">)</span>
<span class="w">           </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="n">resultado</span><span class="p">)</span><span class="w"> </span><span class="n">dato</span><span class="p">)</span>
<span class="w">                 </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="n">resultado</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w"> </span><span class="c1">; ⇒ ?</span>

<span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="nb">+</span><span class="w"> </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nb">cdr</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">4</span><span class="p">))))</span><span class="w"> </span><span class="c1">; ⇒ ?</span>

<span class="p">(</span><span class="nb">apply</span><span class="w"> </span><span class="nb">min</span><span class="w"> </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="nb">car</span><span class="w"> </span><span class="p">(</span><span class="nb">filter</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">                                  </span><span class="p">(</span><span class="nb">&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="n">p</span><span class="p">)))</span><span class="w"> </span>
<span class="w">                                  </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">3</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">2</span><span class="p">)))))</span><span class="w"> </span><span class="c1">; ⇒ ?</span>
</code></pre></div>
<p>b) Sin utilizar el intérprete DrRacket, rellena los siguientes huecos
para obtener el resultado esperado. Después usa el intérprete para
comprobar si has acertado.</p>
<div class="highlight"><pre><span></span><code><span class="c1">; Los siguientes ejercicios utilizan esta definición de lista</span>

<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">lista</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">2</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">5</span><span class="p">)))</span>


<span class="c1">; Queremos obtener una lista donde cada número es la suma de las</span>
<span class="c1">; parejas que son pares</span>

<span class="p">(</span><span class="nb">filter</span><span class="w"> </span><span class="n">________</span>
<span class="w">        </span><span class="p">(</span><span class="n">________</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">                                 </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="n">x</span><span class="p">)))</span>
<span class="w">               </span><span class="n">lista</span><span class="p">))</span>
<span class="c1">; ⇒ (8 14 10)</span>

<span class="c1">; Queremos obtener una lista de parejas invertidas donde la &quot;nueva&quot;</span>
<span class="c1">; parte izquierda es mayor que la derecha.</span>

<span class="p">(</span><span class="nb">filter</span><span class="w"> </span><span class="n">___________</span>
<span class="w">        </span><span class="p">(</span><span class="nb">map</span><span class="w"> </span><span class="n">____________</span><span class="w"> </span><span class="n">lista</span><span class="p">))</span>
<span class="c1">; ⇒ ((7 . 2) (5 . 3))</span>

<span class="c1">; Queremos obtener una lista cuyos elementos son las partes izquierda</span>
<span class="c1">; de aquellas parejas cuya suma sea par.</span>

<span class="p">(</span><span class="nb">foldr</span><span class="w"> </span><span class="n">__________</span><span class="w"> </span><span class="o">&#39;</span><span class="p">()</span>
<span class="w">        </span><span class="p">(</span><span class="n">_________</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">even?</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="n">x</span><span class="p">))))</span><span class="w"> </span><span class="n">lista</span><span class="p">))</span>
<span class="c1">; ⇒ (3 10 5)</span>
</code></pre></div>
<p>c) Rellena los siguientes huecos <strong>con una única expresión</strong> en la que
se utilice alguna función previamente definida (<code>f</code> o <code>g</code>). Comprueba
con el intérprete si lo has hecho correctamente.</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">f1</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">string-append</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="n">x</span><span class="p">)))</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">g1</span><span class="w"> </span><span class="p">(</span><span class="n">f1</span><span class="w"> </span><span class="s2">&quot;a&quot;</span><span class="p">))</span>
<span class="p">(</span><span class="n">check-equal?</span><span class="w"> </span><span class="n">____________________</span><span class="w"> </span><span class="s2">&quot;claselppa&quot;</span><span class="p">)</span>



<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">f2</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">z</span><span class="p">)))</span>
<span class="n">_____________</span>
<span class="p">(</span><span class="n">check-equal?</span><span class="w"> </span><span class="p">(</span><span class="n">g2</span><span class="w"> </span><span class="s2">&quot;hola&quot;</span><span class="w"> </span><span class="s2">&quot;clase&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="s2">&quot;hola&quot;</span><span class="w"> </span><span class="s2">&quot;lpp&quot;</span><span class="w"> </span><span class="s2">&quot;clase&quot;</span><span class="p">))</span>


<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">f3</span><span class="w"> </span><span class="n">g3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">g3</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="n">x</span><span class="p">)))</span>
<span class="p">(</span><span class="n">check-equal?</span><span class="w"> </span><span class="n">_____________________</span><span class="w">  </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">3</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span>
</code></pre></div>
<h3 id="ejercicio-4">Ejercicio 4<a class="headerlink" href="#ejercicio-4" title="Permanent link">&para;</a></h3>
<p>a) Implementa utilizando funciones de orden superior la función
<code>(contar-datos-iguales-fos lista-parejas)</code> que recibe una lista de
parejas y devuelve el número de parejas que tienen sus dos datos
iguales.</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">contar-datos-iguales-fos</span><span class="w"> </span>
<span class="w">   </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">2</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;hola&quot;</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s2">&quot;hola&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">\#a</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="ss">\#a</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">true</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="ss">false</span><span class="p">)))</span><span class="w"> </span>
<span class="c1">; ⇒ 2</span>
<span class="p">(</span><span class="n">contar-datos-iguales-fos</span><span class="w"> </span>
<span class="w">   </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">2</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s2">&quot;hola&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;hola&quot;</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">\#a</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="ss">true</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">\#b</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="ss">false</span><span class="p">)))</span><span class="w"> </span>
<span class="c1">; ⇒ 0</span>
</code></pre></div>
<p>b) Implementa, utilizando funciones de orden superior, la función
<code>(expande-lista-fos lista-parejas)</code>, que hace lo mismo que la función
<code>(expande-lista lista-parejas)</code> de la práctica anterior. Igual que en
la práctica anterior debes usar la función <code>expande-pareja</code>.</p>
<div class="highlight"><pre><span></span><code>(expande-lista-fos &#39;((#t . 3) (&quot;LPP&quot; . 2) (b . 4))) 
; ⇒ &#39;(#t #t #t &quot;LPP&quot; &quot;LPP&quot; b b b b))
</code></pre></div>
<p>c) Implementa, utilizando funciones de orden superior, la función
<code>(comprueba-simbolos-fos lista-simbolos lista-num)</code> que hace lo mismo
que la función <code>comprueba-simbolos</code> del ejercicio 3b) de la práctica
pasada.</p>
<p>Ejemplo:</p>
<div class="highlight"><pre><span></span><code>(comprueba-simbolos-fos &#39;(este es un ejercicio de examen) &#39;(2 1 2 9 1 6))
; ⇒ ((un . 2) (ejercicio . 9) (examen . 6))
</code></pre></div>
<h3 id="ejercicio-5">Ejercicio 5<a class="headerlink" href="#ejercicio-5" title="Permanent link">&para;</a></h3>
<p>a) Implementa usando funciones de orden superior la función <code>(suma-n-izq n
lista-parejas)</code> que recibe una lista de parejas y devuelve otra lista
a la que hemos sumado <code>n</code> a todas las partes izquierdas.</p>
<p>Ejemplo</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">suma-n-izq</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span>
<span class="c1">; ⇒ ((11 . 3) (10 . 9) (15 . 8) (14 . 1))</span>
</code></pre></div>
<p>b) Completa la definición de la siguiente función de orden superior
<code>(busca-mayor mayor? lista)</code> que busca el mayor elemento de una
lista. Recibe un predicado <code>mayor?</code> que compara dos elementos de la
lista y devuelve <code>#t</code> o <code>#f</code> dependiendo de si el primero es mayor que
el segundo. </p>
<p>Al usar un predicado como argumento, estamos definiendo una función
genérica que podemos usar para obtener el mayor elemento de listas de
números, de cadenas, de parejas, etc. En cada caso deberemos pasar
como parámetro <code>mayor?</code> la función de comparación apropiada.</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">busca-mayor</span><span class="w"> </span><span class="n">mayor?</span><span class="w"> </span><span class="n">lista</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">foldl</span><span class="w"> </span><span class="n">__________</span><span class="w"> </span><span class="p">(</span><span class="nb">first</span><span class="w"> </span><span class="n">lista</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">rest</span><span class="w"> </span><span class="n">lista</span><span class="p">)))</span>
</code></pre></div>
<div class="admonition hint">
<p class="admonition-title">Pista</p>
<p>Fíjate que como elemento base de <code>foldl</code> estamos usando el primer
elemento de la lista y que el plegado lo hacemos sobre el resto de
la lista.</p>
</div>
<p>Escribe algunos <code>check-equal?</code> en los que compruebes el funcionamiento
de <code>busca-mayor</code>, utilizando funciones <code>mayor?</code> distintas.</p>
<p>c) Implementa, usando el predicado de orden superior <code>for-all?</code> dos
versiones de la función <code>(todos-menores? lista n)</code> que recibe una
lista con sublistas de números y un número <code>n</code> y comprueba si todos
los números en las sublistas son menores que <code>n</code>.</p>
<p>La primera versión la debes implementar usando <code>for-all?</code> y la
función <code>busca-mayor</code> definida en el apartado anterior y la segunda
usando <code>for-all?</code> y la función de orden superior <code>exists?</code>.</p>
<p>Ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">todos-menores?</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">10</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">30</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="c1">; ⇒ #t</span>
<span class="p">(</span><span class="n">todos-menores?</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">10</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">30</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"> </span><span class="mi">90</span><span class="p">)</span><span class="w"> </span><span class="c1">; ⇒ #f</span>
<span class="p">(</span><span class="n">todos-menores?</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="mi">10</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mi">30</span><span class="w"> </span><span class="mi">40</span><span class="w"> </span><span class="mi">90</span><span class="p">))</span><span class="w"> </span><span class="mi">55</span><span class="p">)</span><span class="w"> </span><span class="c1">; ⇒ #f</span>
</code></pre></div>
<h3 id="ejercicio-6">Ejercicio 6<a class="headerlink" href="#ejercicio-6" title="Permanent link">&para;</a></h3>
<p>Vamos a mejorar el juego de cartas de la semana anterior, usando la baraja
completa y dando más libertad al reparto de cartas en montones, haciendo más
inverosímil todavía la adivinación de la carta elegida.</p>
<p>Usamos la función <code>(cartas num-cartas)</code> del fichero <code>lpp.rkt</code> y la función
<code>(reparte-tres lista-cartas)</code> definida en la práctica anterior.</p>
<div class="admonition important">
<p class="admonition-title">Usa funciones de orden superior</p>
<p>Para la implementación de las siguientes funciones deberás usar, siempre que sea
posible, funciones de orden superior en lugar de funciones recursivas.</p>
</div>
<p>a) Define una nueva versión de la función <code>coloca</code> usando número variable de
argumentos. La nueva versión de la función <code>(coloca ...)</code> solo tiene como
obligatorio el primer argumento, la lista de n listas. El resto de argumentos es
opcional y puede ir de 0 a n elementos.</p>
<p>Se asume que la lista de n listas debe tener tantas listas como
elementos se pasen como argumentos, y si no se pasa ningún argumento
se devuelve por convenio la lista de n listas tal cual, sin variar.</p>
<p>Ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">coloca</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(()</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">())</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">a</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">b</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">c</span><span class="p">)</span><span class="err">)</span><span class="w"> </span><span class="c1">; ⇒ &#39;((a) (b) (c))</span>
<span class="p">(</span><span class="n">coloca</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="ss">a</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">a</span><span class="p">))</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">b</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">b</span><span class="p">)</span><span class="err">)</span><span class="w"> </span><span class="c1">; ⇒ &#39;((b a) (b a))</span>
<span class="p">(</span><span class="n">coloca</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="ss">a</span><span class="w"> </span><span class="ss">b</span><span class="w"> </span><span class="ss">c</span><span class="w"> </span><span class="ss">d</span><span class="p">))</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">e</span><span class="p">)</span><span class="w"> </span><span class="c1">; ⇒ &#39;((e a b c d))</span>
<span class="p">(</span><span class="n">coloca</span><span class="w"> </span><span class="o">&#39;</span><span class="p">())</span><span class="w"> </span><span class="c1">; ⇒ &#39;()</span>
<span class="p">(</span><span class="n">coloca</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="ss">a</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">b</span><span class="w"> </span><span class="ss">c</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">d</span><span class="w"> </span><span class="ss">e</span><span class="w"> </span><span class="ss">f</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">g</span><span class="w"> </span><span class="ss">h</span><span class="w"> </span><span class="ss">i</span><span class="w"> </span><span class="ss">j</span><span class="p">))</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">k</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">l</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">m</span><span class="w"> </span><span class="o">&#39;</span><span class="ss">n</span><span class="p">)</span><span class="err">)</span><span class="w"> </span><span class="c1">; ⇒ &#39;((k a) (l b c) (m d e f) (n g h i j))</span>
</code></pre></div>
<p>Implementa una función <code>reparte-cuatro</code> inspirada en <code>reparte-tres</code> y con idéntica estructura.</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">reparte-cuatro</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">A♣</span><span class="w"> </span><span class="ss">2♣</span><span class="w"> </span><span class="ss">3♣</span><span class="w"> </span><span class="ss">4♣</span><span class="w"> </span><span class="ss">5♣</span><span class="w"> </span><span class="ss">6♣</span><span class="w"> </span><span class="ss">7♣</span><span class="w"> </span><span class="ss">8♣</span><span class="w"> </span><span class="ss">9♣</span><span class="w"> </span><span class="ss">J♣</span><span class="w"> </span><span class="ss">Q♣</span><span class="w"> </span><span class="ss">K♣</span><span class="p">))</span><span class="w"> </span><span class="c1">; ⇒ &#39;((A♣ 5♣ 9♣) (2♣ 6♣ J♣) (3♣ 7♣ Q♣) (4♣ 8♣ K♣))</span>
</code></pre></div>
<p>b) Implementa la función <code>(escoge-en-orden lista funcion_ordinal_1
... función_ordinal_n)</code> que aplica a un primer argumento obligatorio <code>lista</code>
la serie de funciones "ordinales" (<code>first</code>, <code>second</code>, <code>third</code> ... <code>tenth</code>)
pasadas a continuación de la lista como un número variable de argumentos,
devolviendo la lista de resultados de aplicar esas funciones en el
orden en que se han proporcionado.</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">escoge-en-orden</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span><span class="w"> </span><span class="c1">; ⇒  &#39;()</span>
<span class="p">(</span><span class="n">escoge-en-orden</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="nb">fourth</span><span class="w"> </span><span class="nb">second</span><span class="p">)</span><span class="w"> </span><span class="c1">; ⇒ &#39;(4 2)</span>
<span class="p">(</span><span class="n">escoge-en-orden</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">a</span><span class="w"> </span><span class="ss">b</span><span class="w"> </span><span class="ss">c</span><span class="w"> </span><span class="ss">d</span><span class="p">)</span><span class="w"> </span><span class="nb">third</span><span class="w"> </span><span class="nb">second</span><span class="w"> </span><span class="nb">fourth</span><span class="w"> </span><span class="nb">first</span><span class="p">)</span><span class="w"> </span><span class="c1">; ⇒ &#39;(c b d a)</span>
<span class="p">(</span><span class="n">escoge-en-orden</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">dos</span><span class="w"> </span><span class="ss">tres</span><span class="w"> </span><span class="ss">un</span><span class="p">)</span><span class="w"> </span><span class="nb">third</span><span class="w"> </span><span class="nb">first</span><span class="w"> </span><span class="nb">second</span><span class="p">)</span><span class="w"> </span><span class="c1">; ⇒ &#39;(un dos tres)</span>
</code></pre></div>
<p>Usando las funciones definidas anteriormente, implementa las funciones
<code>(reordena-tres-montones baraja f-ordinal1 f-ordinal2 f-ordinal3)</code> y
<code>(reordena-cuatro-montones baraja f-ordinal1 f-ordinal2 f-ordinal3 f-ordinal4)</code>
que reparten las cartas de una supuesta baraja (lista de cartas) en tres o
cuatro montones (lista de sublistas de cartas) y después reordena los montones,
o sublistas, según el orden establecido por las funciones "ordinales" pasadas
como argumentos a continuación de la baraja.</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">reordena-tres-montones</span><span class="w">  </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">A♣</span><span class="w"> </span><span class="ss">2♣</span><span class="w"> </span><span class="ss">3♣</span><span class="w"> </span><span class="ss">4♣</span><span class="w"> </span><span class="ss">5♣</span><span class="w"> </span><span class="ss">6♣</span><span class="w"> </span><span class="ss">7♣</span><span class="w"> </span><span class="ss">8♣</span><span class="w"> </span><span class="ss">9♣</span><span class="w"> </span><span class="ss">J♣</span><span class="w"> </span><span class="ss">Q♣</span><span class="w"> </span><span class="ss">K♣</span><span class="p">)</span><span class="w"> </span><span class="nb">second</span><span class="w"> </span><span class="nb">first</span><span class="w"> </span><span class="nb">third</span><span class="p">)</span>
<span class="c1">; ⇒</span>
<span class="c1">; &#39;((2♣ 5♣ 8♣ Q♣) (A♣ 4♣ 7♣ J♣) (3♣ 6♣ 9♣ K♣))</span>

<span class="p">(</span><span class="n">reordena-cuatro-montones</span><span class="w">  </span><span class="o">&#39;</span><span class="p">(</span><span class="ss">A♣</span><span class="w"> </span><span class="ss">2♣</span><span class="w"> </span><span class="ss">3♣</span><span class="w"> </span><span class="ss">4♣</span><span class="w"> </span><span class="ss">5♣</span><span class="w"> </span><span class="ss">6♣</span><span class="w"> </span><span class="ss">7♣</span><span class="w"> </span><span class="ss">8♣</span><span class="w"> </span><span class="ss">9♣</span><span class="w"> </span><span class="ss">J♣</span><span class="w"> </span><span class="ss">Q♣</span><span class="w"> </span><span class="ss">K♣</span><span class="p">)</span><span class="w"> </span><span class="nb">fourth</span><span class="w"> </span><span class="nb">second</span><span class="w"> </span><span class="nb">first</span><span class="w"> </span><span class="nb">third</span><span class="p">)</span>
<span class="c1">; ⇒</span>
<span class="c1">; &#39;((4♣ 8♣ K♣) (2♣ 6♣ J♣) (A♣ 5♣ 9♣) (3♣ 7♣ Q♣))</span>
</code></pre></div>
<p>c) Implementa la función <code>(junta-montones montones)</code> concatena la lista de sublistas
de cartas (montones) en una sola lista de cartas.</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">junta-montones</span><span class="w"> </span><span class="o">&#39;</span><span class="p">((</span><span class="ss">4♣</span><span class="w"> </span><span class="ss">8♣</span><span class="w"> </span><span class="ss">K♣</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">2♣</span><span class="w"> </span><span class="ss">6♣</span><span class="w"> </span><span class="ss">J♣</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">A♣</span><span class="w"> </span><span class="ss">5♣</span><span class="w"> </span><span class="ss">9♣</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="ss">3♣</span><span class="w"> </span><span class="ss">7♣</span><span class="w"> </span><span class="ss">Q♣</span><span class="p">)))</span>
<span class="c1">; ⇒</span>
<span class="c1">; (4♣ 8♣ K♣ 2♣ 6♣ J♣ A♣ 5♣ 9♣ 3♣ 7♣ Q♣)</span>
</code></pre></div>
<p>d) Una vez que has implementado las funciones anteriores ya solo te
queda copiar la siguiente definición para poder hacer el truco de
cartas. </p>
<p>La función <code>(adivina lista-cartas par1 par2 par3)</code> es la que hace toda la magia
y calcula la posición de la carta escogida a partir de las posiciones de los
montones en los que ésta ha aparecido en tres reparticiones de la baraja.</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="p">(</span><span class="n">adivina</span><span class="w"> </span><span class="n">baraja</span><span class="w"> </span><span class="n">par1</span><span class="w"> </span><span class="n">par2</span><span class="w"> </span><span class="n">par3</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nb">list-ref</span><span class="w"> </span><span class="n">baraja</span>
<span class="w">            </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="n">par3</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="n">par2</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="n">par1</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="n">par2</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">cdr</span><span class="w"> </span><span class="n">par1</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="p">(</span><span class="nb">car</span><span class="w"> </span><span class="n">par1</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="p">))))</span>
</code></pre></div>
<p>Cada pareja codifica en su parte derecha el número de montones en los que se ha
repartido la baraja y en su parte izquierda el montón en el que el espectador ha
visto la carta. Por ejemplo, la pareja <code>(2 . 4)</code> representa que la baraja se ha
repartido en 4 montones y que la carta escogida está en el segundo montón.</p>
<p>Lo curioso de la función de adivinación es que funciona correctamente siempre
que se haya repartido la baraja dos veces en cuatro montones y una en tres (las
partes derechas de las tres parejas deben sumar 11).</p>
<p>Veamos un ejemplo de realización del juego, tal y como ya hicimos en la práctica
pasada.</p>
<p>La siguiente función, con la constante 90 como argumento, genera
siempre la secuencia aleatoria que permite seguir el ejemplo. Si se
cambia por otra constante, la secuencia también se reperirá siempre
aunque será otra. Tener siempre la misma secuencia aleatoria permite
poder depurar la programación trabajando siempre con el mismo ejemplo
aleatorio.</p>
<p><div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nb">random-seed</span><span class="w"> </span><span class="mi">90</span><span class="p">)</span>
</code></pre></div>
Si en lugar de una constante se usa un valor variable, se obtiene una
secuencia aleatoria distinta cada vez que se ejecute el programa. </p>
<p>Ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nb">random-seed</span><span class="w"> </span><span class="p">(</span><span class="nb">modulo</span><span class="w"> </span><span class="p">(</span><span class="nb">current-milliseconds</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">expt</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">31</span><span class="p">)))</span>
</code></pre></div>
<ol>
<li>
<p>Repartimos una lista de 48 cartas en cuatro montones. Pedimos a un espectador
   que nos diga en qué orden colocamos los montones, poniendo, por ejemplo,
   primero el primero, después el cuarto, después el segundo y después el tercero:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="p">(</span><span class="n">reordena-cuatro-montones</span><span class="w"> </span><span class="p">(</span><span class="n">cartas</span><span class="w"> </span><span class="mi">48</span><span class="p">)</span><span class="w"> </span><span class="nb">first</span><span class="w"> </span><span class="nb">fourth</span><span class="w"> </span><span class="nb">second</span><span class="w"> </span><span class="nb">third</span><span class="p">))</span>
</code></pre></div>
</li>
<li>
<p>Visualizamos los montones y pedimos al espectador que piense en una
carta sin decirla. Por ejemplo el as de tréboles. </p>
<div class="highlight"><pre><span></span><code><span class="n">t1</span><span class="w"> </span><span class="c1">; ⇒ ((K♦ 3♦ 6♠ 6♦ 3♥ K♣ 8♦ 5♦ 6♣ 8♥ 5♠ A♣)</span>
<span class="w">   </span><span class="c1">;   (8♠ 8♣ 9♠ 7♠ 2♣ 7♣ K♥ Q♠ 7♥ Q♣ 9♦ J♥)</span>
<span class="w">   </span><span class="c1">;   (4♠ 2♥ K♠ Q♥ 7♦ J♣ 9♣ 6♥ 2♠ 9♥ 4♣ A♥)</span>
<span class="w">   </span><span class="c1">;   (5♣ 2♦ J♦ 4♥ A♠ 5♥ 3♠ J♠ A♦ 3♣ 4♦ Q♦))</span>
</code></pre></div>
</li>
<li>
<p>Preguntamos al espectador en qué montón se encuentra la carta. Anotamos en la
parte izquierda de <code>p1</code> el montón en el que está (montón 1), y la parte derecha el
número de montones (4).</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span>
<span class="n">p1</span>
</code></pre></div>
</li>
<li>
<p>Repetimos la operación con <code>t2</code>, pero ahora repartiendo en tres montones nada
más. Podemos pedir a otro espectador que nos diga el orden en el que se
colocan los montones. Por ejemplo, primero el segundo, después el tercero y
después el primero.</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="p">(</span><span class="n">reordena-tres-montones</span><span class="w"> </span><span class="p">(</span><span class="n">junta-montones</span><span class="w"> </span><span class="n">t1</span><span class="p">)</span><span class="w"> </span><span class="nb">second</span><span class="w"> </span><span class="nb">third</span><span class="w"> </span><span class="nb">first</span><span class="p">))</span>
</code></pre></div>
</li>
<li>
<p>Visualizamos <code>t2</code> y determinamos la pareja según donde está el as de trébol:</p>
<div class="highlight"><pre><span></span><code><span class="n">t2</span><span class="w"> </span><span class="c1">; ⇒ ((3♦ 3♥ 5♦ 5♠ 8♣ 2♣ Q♠ 9♦ 2♥ 7♦ 6♥ 4♣ 2♦ A♠ J♠ 4♦)</span>
<span class="w">   </span><span class="c1">;    (6♠ K♣ 6♣ A♣ 9♠ 7♣ 7♥ J♥ K♠ J♣ 2♠ A♥ J♦ 5♥ A♦ Q♦)</span>
<span class="w">   </span><span class="c1">;    (K♦ 6♦ 8♦ 8♥ 8♠ 7♠ K♥ Q♣ 4♠ Q♥ 9♣ 9♥ 5♣ 4♥ 3♠ 3♣))</span>
<span class="w">   </span><span class="c1">;En este caso (2 . 3) (el montón 2 de 3)</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span>
<span class="n">p2</span>
</code></pre></div>
</li>
<li>
<p>Repetimos una última vez el reparto y ordenación de montones, pero con 4. Hay
que hacer tres repartos, uno de 3 montones y los otros dos de 4, pero no
necesariamente en el orden en el que se ha hecho (4-3-4). Se podía haber hecho
primero el reparto en tres montones, o haberlo dejado para el final. </p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">t3</span><span class="w"> </span><span class="p">(</span><span class="n">reordena-cuatro-montones</span><span class="w"> </span><span class="p">(</span><span class="n">junta-montones</span><span class="w"> </span><span class="n">t2</span><span class="p">)</span><span class="w"> </span><span class="nb">fourth</span><span class="w"> </span><span class="nb">second</span><span class="w"> </span><span class="nb">first</span><span class="w"> </span><span class="nb">third</span><span class="p">))</span>
</code></pre></div>
</li>
<li>
<p>Visualizamos <code>t3</code> y definimos la pareja <code>p3</code> según el montón del as de trébol: </p>
<div class="highlight"><pre><span></span><code><span class="n">t3</span><span class="w"> </span><span class="c1">; ⇒ ((5♠ 9♦ 4♣ 4♦ A♣ J♥ A♥ Q♦ 8♥ Q♣ 9♥ 3♣)</span>
<span class="w">   </span><span class="c1">;    (5♦ Q♠ 6♥ J♠ 6♣ 7♥ 2♠ A♦ 8♦ K♥ 9♣ 3♠)</span>
<span class="w">   </span><span class="c1">;    (3♦ 8♣ 2♥ 2♦ 6♠ 9♠ K♠ J♦ K♦ 8♠ 4♠ 5♣)</span>
<span class="w">   </span><span class="c1">;    (3♥ 2♣ 7♦ A♠ K♣ 7♣ J♣ 5♥ 6♦ 7♠ Q♥ 4♥))</span>
<span class="w">   </span><span class="c1">;Esta vez es (1 . 4)</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="n">p3</span><span class="w"> </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span>
<span class="n">p3</span>
</code></pre></div>
</li>
<li>
<p>Ya tenemos las tres parejas mágicas que nos adivian la carta:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">adivina</span><span class="w"> </span><span class="p">(</span><span class="n">junta-montones</span><span class="w"> </span><span class="n">t3</span><span class="p">)</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="n">p3</span><span class="p">)</span><span class="w"> </span><span class="c1">; ⇒ A♣</span>
</code></pre></div>
</li>
</ol>
<hr />
<p>Lenguajes y Paradigmas de Programación, curso 2023-24<br />
© Departamento Ciencia de la Computación e Inteligencia Artificial, Universidad de Alicante<br />
Domingo Gallardo, Cristina Pomares, Antonio Botía, Francisco Martínez</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.51198bba.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>